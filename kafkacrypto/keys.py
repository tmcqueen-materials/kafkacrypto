import msgpack
import pysodium
try:
  # until more mature implementations are available, use Open Quantum Safe
  import oqs
  import warnings

  # In order to support SLH-DSA-SHAKE-128f, liboqs needs to be at least 0.8.0,
  # which is the version to have added SPINCS+ 3.1 support.
  # It then needs one additional patch to swap FORS bit indices order to match
  # a change in FIPS205.
  # To know if we are using an appropriate version, we just test with one of
  # the NIST AVCP tests.
  # TODO: when liboqs adds official SLH-DSA support, just replace this with
  # an instantiation of the actual call
  # ACVP SLH-DSA-sigVer-FIPS205 Test tgId=16, tcId=211, internal interface
  slh_pk = bytes.fromhex("9648D5D6F2C708585B92E57339AE4006356AA35BABD5224D189E0954B1009A3D")
  slh_msg = bytes.fromhex("C1835E59DC028FBF22C7DD4D98E9C323D79CD5D64C52D88D40AC27162C4F41A2C50565CA73704B96B767502B1D5C32A3CAAB44EE35ECB1274DD2CA2799462772F3FAA9CA8C8DCE1B8B0BC2FE7925600BD3C15D53C1359C6ECFF257428BD6A17A65CA507D67066427FF0623D25B8119A41456FD3BC18D3C447711D0F0B4CD22AFDD1D8093C97461D1FC1EE1FE791480A0E30B0FAD857F98E65D1AF2C8D76145E0049DE6DB22FCAF240483BA5973995E6AD9A851FAAD264CC4F9A28F79996554B7775498D87E59493505BDD4D2439188EC938B2D2C18BD349D7665346B31B5E1D855FEEAFC86F2F507D46AB7E2C3C3292D0EC02E7B3DA9B562501FCB74601D9FBDA098956CBF97ADC2066BD5CE2085BC42D99589D1728271EA6AAA9334B5FC72AA39D768800502C39792A1FDAF94200DE4538170D3C8D89408189A6F832F3F64041A6AEE2D6A10C3496951A9078B8A85DA2DC2741A008D142705D290C94C2CE93CA8883919FA3AA6C89C7060DC0099DBA964BBAF187C0D8C5484E96810D85FBAC92EAAA16633E995DDDBF0278CE198116DE3682906F618E64AEF6C03901781B8C3FD42751107BF128DC2A63062577BC0877980929123B80CA4BCA826457758830B537F08A1208BED76FA4CBE02BCA3F215B17BE89B8D0C4306E4969CF4360CDA81A9EC064A917203621B209D67BEF03A599D5C5151D92CF859CA991423ED089698B47DF2F6FC907103CCC1C785650DA0F8BA8AFDCCA48EFE9CE303DA0375CF24E3A503755EE8F4E39A29F6E0D7C8DB5CA59D8AF311EB3C9B29DCDBEBE02A9BF9AD999061C2B33D82AD9BE90940B7DA77CEE4059E6F7CBD7307C5289C6AA27F84323698B240AA40AA3BF970CE5F43615178468D60AECD30454BD00B035D787C1E6A494CA10953BD5B44B46BA0C1094412C88515E6C0EACD7FD8A105FE05855FA79932D8A4562AD78D2D4E4B7C4C08E651CE1188BC20165043EDA3CCE0E1EAA98F30B8A9A85B1324514235FC112DBB22A481E7E9AF148F5F43DA33B87B7B1AC32A5F78376FAD6838B8C19D4C7F592B76A61E47FAA41509086727561094CBE5EE8EB4563DA46141EC7C8BFEB91DF68699EBC7846069A978809D1D98B19AE4C4B67ABA4306F2163E2A7FB1A31C95A625FFD9F0F5588160A8D2BB4854E28BC19E20A8935F43F6608AE02005C0127B33C8F100237338056D49DAFD39667DF75F3040C41E4F5D9726224C28FAC6CB3AA60B21C54B42BB02623FF8F1F76919ACB3DBE7D1FBB986548E3D42DE759B44663AD266521330D246013C7DA5A4ECD56801C2C43F2C050D0D5E34F61E88BC3EE0E59DDDCCD11B6E771A13D708C6E589845BCA9BB47C2903189F386E82A7EC59D844448B2E7130329D764068301EAC45CCB79E0AE195832570CB4FFD04B8E5B78243F5B50BB1402366AC3038A199CF679C3C26675F6F9DCDFA503C6F9496DFCDAEE102FF854982F21EFD7A7F627D75AD3AE493E385949985437BFE8EA45F21E02B92B616460A4C3020ACFCF9F4E148F9DEE1CEB5760B6064F7490AD279A39F1BF76E60AB76538E099A0AEFE6F991CE4D4D7831447A184F8C3D2C6AD513E63A1092F58AC22E9571102548CDC5989E91611E1DB8B4B3311081318F40E863B45268D087848BF3ED6B052CE5758B99801C7E15CE8A654E0A9717807DAF9A9B9EF59BD46746B41DA730A98307BF4A4991FFE129DC87595026CF163CA2322396EE0CEC30BF1C9962465B9C27DB8C1E21D3B9B3A04688A88A255AF001A9FA784357840F25E01E0344A027B284117EAB16D0C0361A767A1AFE32CD4EC260398AF8E0AEA586A2EFE10AD4291B6187DA57731C513A33F358F2FC0BB214C229D76DBB89395F69F2C8670BF32A73687726B0478F7799CEF513324018974E0AFAD535489292873722E7EBB61F2F4626980A9459BC0F975E1F004D10718251DE7E873A3A500C730B806D5727D6B9CE4223A3C26975CD91350F8654059D07A5790EC270ED726AC95B730A274E45A6E47405EB1716FB5FA0EF74ADA41A67E615A7BC9CCEBB2ED32E3BBABDC916BC06E2B3A0BCECB3AF6115DC7D9EC1A1A684183C20E455285A8531F19FC778103C1E8D364E4A9F8023358B11C428415FC5CD0232CE05344A3D31FE403D10E93A72DA05BFFE876FA8B7E742542E925958C66F028801EBEB41DD8BBEBDF35668668ABAA31E8107CFC756041DB94712D6FBEEF196A67674F416F886C6CD4FC5ADD5A18967048D484A5C1578FCF601E3C7A4590D82A12B09F0F2BE3166CB64E44052FB1F9D0FB62F087193C2B06666B3475E512AB19017A9F43E991D3396B9DE1EC5DF62AA494119CE0B9D9A4A2048890FF2C71FA982AA1FB5A668DF29843AA60BDEE2F8EF75A50E7DFBAD5BAFCC4F5D1DC2A26E3DC4BC01BECED84F58BF157C674D679A7D664BB26004E4668468EE8DF5C09E3E00A1F472785F5F3B280513616131C49E5A451DBC00A310313735611D0A00556B2177AE2BEBC1DF9B224C5570361B9BE586F88D4B2CBFB5AECDDF3458FB81877D764A7DFC174A96E7904A7CB652DD116C8D5C9F917ECCB69F73C57682A970E59E02A84E47882842268A0B17E25F29744461DDC8E1208A26C49105255A7121F3A82CDBDFC721734A563DC01BA49047A59920E7A39D181279E26F6FBAD27E80E6A6B0A82A04C2952B057AE1F39A6C96344CD8A3DB57C7A45057DFA25D4D78C537315A873AC4947D3DFC3F6A4169695884CDBC3397B6B2402EEA6DBF81FF916A6FBC4B5DF3F063F07F6F5A8D98F58FBE1660A1EFB8E781838E4D789DB514EC9789D75FD02780B925BC741A1839418EA68822D36E971B42CF8C73DDAC151F659A8794CE269C17E0E9CE380AFAB60DF66CFA8EBD1BAE742B58FEFCE80869885EC76FD1262FAD8834463D82E2C27440CB747B473574E6D56CAEC47CAFD05E1E6BB1FB7F3B828272B32F02A4F01B22EFD4ADCC4627D5395A46AB54A9A261B837EA2E9D04B249EE98BBA31C6ECE2D80C05766DD6807484C09B5AEC82A1A3E15D09ED1D170DB7955B216D48F74DEEF080ED56EE7B8315608BC9E787E08FB046C4A18FB5ED73C552E3E1E0FBE1004EB8134B6C32F86882ECCFCA90DC509B774C1D5E5945F6023BFD204F570E6FE53B2C96482367CBCDA52DE775C81960F5A24AE040E12C2CE4F046A338009D867A6297E3F1C1F2D6678CFE7A862AF648EF2530DCED78C27D1F1E684B09CF58CC1FA4127C110886268F2869035E3B4B5D3B407280DCAD3A9CDEA8EC87F8820EC0905CA5D188319951B60D8A18159125FBA660CD089FF928B5759AADAA5A4C3409407EA48426E1BDF8590289F562A0377C4336C43C8B4F4F44D0DCB33639E2643002ECC85D1D79326A9D4857EF3DF99238D0D78CBE7C46E618DBB1FD695C4B40A0E1C7FEF4E90853DFF5407371681B06DE361F817A9355F7F1D1B165714937BB00B9BFFA34C7C858525210147438C7CA313346A1075C0A60EC0CC6BD316AA5F019B4BC39224C3A14D726DD84F431F4B89EE2D01739416FBCF2E2467EECAF7F3FD7144678F156BD014A7FE27708FD53327BA36CB0AA7D04503DAD9FDF4D8494C99DE6725774706C0B937A944DA19D6A82C193F371791D26596BCAE96D52507BEECD9414738014D66F14E5CDD0D6702B170AE22FC963525DB25A026C4AEF70E1615B6ACDCCB47574E16D66D3D6CF805BD815C8DE43B1C7599B60C8E8F4F643C5E8BC9D51224830EFE925E190CCFDBE8B42F7629EB5699E0EAC9D160D946EAAD30E23C1855AD3433AA47E47D1B073E6A16E6D479FD941F9BA41E8246582E56E3107A214A3AF2CF89A873BD0AF13DFE6D0F298F3029FB27512C760B2436DDA66752D5BB1A744E94A517FE7424E64C11AF43B924FF96A8B8CC949698CF98E6871D97A35603ED4226342925D8E1C7BBE7C545A40ABDFB3E0BA8D8A95C9B82BECBEFDF3CE0CD1157544E761F3EA1509176F1311B8D64D567597871685A42909D5367C728733EAD18E1D308E02554B77D1033ECEC38D6259218537A8DE6F32A5D2E9C74F51E60C462DE69F1B2F6EDBAD405585B859FBE39C75CE58937A18B82D386FECEDF29BDD56BB88BAB719E8278A18B1C1868C6B05BFD7B9DB2F4CC7DEE89DB90356E8F45F01EC02136FBBCB5650EDA55B590145D63BB6D5E251ADB968DEE876727049152F740AC2DC6296CC95BA0B88E8A596C76F10294C6C087859D4C864AA2C417561E9D64AF2106065FF7812EE5AAB7281DD8914B7F7D222EB6A761B2332520EDF7414B6FB6A731FDC2707FB6F4772EE74F80AC6B90BB58A18E530CE01FC876DFAE75A5149207A9C9432207D71FB082C287817BAA05CE639D55DE775F71751FC9489F67763AB668CB2BB23AF458AE7F05B37D553F92BE7E15ECE0CAFBD2D47C7E1660859FB53540DDC00D6984E4507D1FD94934EDF3362ACD3E1CAC7B9429D894361E44D6CD594EE86B4975BC8CBD32985B5E25AA68B29C5B3653F8041EAB2736CAF54116E8D97EFEF49CA0909161213621CA26BB60A28977342DAF4C5742840BD9071DAEF45363821A854DF12AD188E6A05046A2B6003EE8A335694B5B9884428ECA611948C287686DDDBB9E8B2DAC9E790BE5DC8513D53A2166707BBBD05FD524D91FD77001F2862CCCB58B3B5F4E13B0251CBB6EA81BADA1D11B3A48B3342369F6FED9405DC395C65384A0C0760C3DA0B82EEFF3C8CC23B25F343397B9DAB16C7602479CEECBDF140F833ACCCD0DD605B2F32264A0996B3E9BC80C3DD8A54A8E506ECE4C12F093DA93908D340ABE7A6C720C3C036802DA454F598D82A673A59DB7458B487A4812EFF78A667BDFBA98284AB2B07E4202D4DBB6489424DF8B65FA0C6CEFA3E7C51F228A7F053DDE918EE47E6C0D0B6DB10AA6E8720D996A9D6FFCC7440D6D9F169558BE1E2F4DA9BD4EC4E2FFC14F872D3F19DA8EBA7D1DDE40BACCAFFA2C5670E340BC9538ADCAE435A2EF2B78AB573CACC27163DE825751EEF7CBFA31DE5F3EEF5AAB198B34EFB17CB81111CE0BD50CB4FE8D596B46CB8E5948C9285E479D46B3BE374DB80C3B391BDCA9A911B099B71F2A42CE2413FD27A86325C76D0B8E266222C168C3F536F6CDB26D686D74F17F0F3733EC6EFF687527FA43EE0308EB8945171D032FA8EE5316B0CE8D892421EB5128D05994D33D8026F111B2484DA79C3FF78D8F6043A7DF90C7BFAC7F8E6739AD8C3BAAA52B80D2A67E46D7887F1BD65C4E1CF15ECE788DD3758414A6E4FE6CC99931632304EA5BE8EB5ED8D17A5415DC66907EFB31D3DEEF5FAE8F8669BE04561752DC94F73CECCC172331AD68ED81040B7E64E854841C76C65B60F1B6730B1C0B40BEFC58205ACA78D2804E49A54BC09F46FA74DB1096D64F35B55206659F98717B53B3AD214A05F23FF9EB5B6BAB7CAD6756560C7D985FF36B1EA3264D0971BEDBB9F521F927F69C06F173708A416DD9DB9F10D75D742B7075ACD417E70CE4B269769CD984574D772EB380A808D5A03F358B3232BBDA3478937979469E244F879A7B452B81A3640DD2CBB292ECBEEAEFF3723C37937F2DAEA11D7CE9642042E0466D66F2C494B272C2C5B1E989D6961063DE67E10596F4006E09BF331526D284B53B6982CE4DCD5B5341CD877F9CB86151920F37A4F81CAFF0354091EF06B48F4C31854138E7A272150BD92145E436AE9BAF39C9B61FB53A7DA16A71C0E3662D63126CB54A53118A5CC5565A339A505AA70074563317A2B8E7CF954972FF386C660CBB963FDDAE0F056DE158D89C0A12EBDC70F84FCC3A1FA8AB93F86317F73D1D2EF73DAC3C3617F8C4236D374A647AC8F860693C569B5D4A68D275F4A6D329DA18A23C17D30B4C46AD4EEA2A84887B21889F3740D256C06A0E10B8887CC547AE4DF2BFC68502672FA03C9217056B5B205BF2BAED8276CDD769C11A3A3BED824065F095E0A9D613428CB9B6A02E292C284BF375FF05AC9FE2D2689C9944F4E957DCC0403294A614D0F1BF9A21599F40055A5F2E24445F01A6222A86BDA7050127DB0F3F6E2F87877A18BA5E0653C10D5926439E461BC4671C2F70B91C212C8B50C6EDE366F96749F9A54AE9AB7B3016DC46A8EA3255C814BE7639D678802DC40166D9376A9E53011076F40E3083DD5605E83949E62EF12AFD5781B9FB77BFEDB47B6C89D136FF168F8E18247FC56C402F344E376EE1406EEFAB6E69B4E290289B74D49DC30D8B5320A82B269CE1D56BC0369C8BA05A62881830965C8A1FBEBBB4B40655312D76CBC0EF92D06A589E8608F888739D44DDA1CA05CA39D94B42B379967E3B68DD6449A93AD07EFC2C8EE2696FA8CDD2375133F06E3395771F06906D8FFDF93B08F6B0C65BABEE77CD10FD9B4159DFDBB042768FB9435E8D2AA55429474C0C292924C34F837E14AEE0EC34CDC1BF1C742FD8BA9B27225FCC4534447059CF6401DEBE5B5ECD0EB36ADE9DB2190FA3C26E16AEF8AC4EEAE88483915D37E9F24C92064471832E3322278408860FA7E35DA26B2D63A6616A464F418991F036377364AC59FC6D462D9C79545A16943A290E1582936F5C57F9EC02B1B8B0CAAC77829A9DC138B6F8DF36DB89BB9F4E6CF707F2543E68B8D21026E50FF54C7D092534F4A8838B421B6253EA4C426D7DDEFCF7FD35BAF0E16B2A1D280354184CC9821DF6387E4A64F53DAC441FD3E2F039293A28411600261C6D72F3E7817FC8A773BE2F32A6A71825391436E10D4EDD1D05A9831DBFC088B24F9DE0966F9D09748D516EB100F6E3AC57E8029EB276B94D0962858AF456F9E2702F288954700D3BB2E957C79CE6808B347773B9A3F8E1782734077DD9BC5DE5180B9881811724CAA1A59694EFE18110E05F46513B11EE08B1AAA1783BAFE0497D47A81EF760EA7AC9AFCA91019222C8AC422CB905DA2CC1298FE26C92ED7A6C36972712A92E520D184C2C68D3189893163466B51C17E1A459524D496D03C7F5189EA99A2639FD13F748D1E77F861377D9506F59E3920AE0314D4BA7414A55E933ABEEE68F72E3868E494826F713F1A5F98E94C3EDFAA10784380C09C08B5C406FC8FA712B0C066E145D5484998F183E560B329E8AC5B22E1D1AF395E1F7E3E2CDE2B60F5248B12B2D1F899F28BE2177CDED00A46E2A2225D84CB9DC38338D9DFD7D43BB06E62C57B0A0C8ADEB8A7BD6F62BC86E95E060109DBCF67EA061CCF5CC742AA39518A3965C9685CE3BBFE2CECB593D04295A122721D8D3AA7C88ED356F036CCD5846303430F1C9A70881E9706673078D963BF9394282EAC54CD388263D8D50242F4941D2E7D440229354A90B9E207D05AF2AC2BF289C179A19180871145DFCB18D8790E478B6B858FB22D6591D03DE55449C83393FDDABC02EBA89A02D3C456AAEC70F7C75C2A13264019DD45D4555A2B836AE5AC7AA799C0306A71AE91D5A99F6339F72A6978BF2F64AE4B87AAFC6D5D472BD87D53C9D4E3AB51301B5987D48BA1784231A291576BD839664F8B35217075CB3666514B07B57BA9CBC0D49768DAFDD6CCCC7CE3287D8239C86B7F408D672214A2C252D2526E44BF14DB1EE9A5A0A4D59018AC4395289D9938B3B94C648074EAAA7A481DA08DEF7910020BB616CAED81B7D3D10251DC9EFAE0036031E754B1209125A483226CB9611B0E1024137D9C98F590A115B116105F0D7A7A69FF0A7730262F33A353D31268F98218622B9C655A6D5F4C5E84E74FC4D9086644C5B2F333604BC088D809F831EF260CF0EAE96763BF401CF23DE77BF6A81BBD5C05019EF682F35B930024AA7A417A3600DDF7E086546B5654A98626CBDEC0AD728449AC2526DAF8CB7FCBDF1594C67864A35AB7459E3195B136C5C17BBEDB5EDF3A3F30C9DEE95B953D7EB7FA2C8D1A7B01E5A73DAFD7B1C5038B1E8260263A37B5FBA2BF317A4A4A98672D4FF6993C454831A1F91314DADCEE72441933E3FC6ABEBE8358D252ACA3DEBA528AB4A037479442765C80F8F649547501EE2E2904EAE1D1F03DE0D097BE9E32E2096E3F51F060623238DEEE3CAEEC74397A113AE6C0B3B0BA06A097B9D68B554ACDA7D2CD8DFF232904E9B8ABABE890D59AB72313D90089EC2BCD412389672BF18A9A254FB21EE09D2513E74A9FEC7757C42111027CDFD4F2E794DC7E8C583CEC244888233054F6BBB9AFF3BDF36170F83BCD8BC65")
  slh_sig = bytes.fromhex("9425A2683CFE18AC5B6B4844D67A5A2CC18A3479182A2CEDF50923C04DCC5DB0D65EF6359DFD15E037E8C22B9EBD651CC42809F5FB316FB97E80655C10001A1ACCCDD5D36B249C8AB2321CD5B80BD9B70CB23526150BB7A687472AD23D8E43A0CF5AB16356A31D18FB756BFB0826388F793265A4B21A5757D3182D6A77A422DC3AFAAE6E693C4E6C6D616130C186BFE2D7DEB5C25A51E8AD2AF648794AD56A9517D0EDF2CE44418F7DE718E2541FEDFA9E6C2B6CC10714DFF607A1CAED543B4185434540F2BDD34839C9AD4BC41BBE0095A9D063CFE1642773FE17AFDF901F88EDFCD7852F1C29F5BE701712DB819085E79B22165D34FCB678867F5B16D31909BAB83998D954D8B34FAE9CABA0A55695EC70EFC357E765DE75F17E6F6B7D1541A1382ADDAACAF956BDBC85BDB34BE302B769B3FD2D500C8E5A9332CC89ED9BCBFE93F225FF20654EA61A12AE1552C51FEFBC7BD2A0710A755523BCF0926388DD1A9406E2E9719009FE288F647A0EA4656F63624627E1A95525F58983C8C4F8FEF65C7B10C462D31C43F2A64AABFA79A979EB87EC3A306AE50A59DE8141BC685859F0FD53C15B9C918CF054D2A41D886BC9E15BDB697E0413E6484D2A3F2F1EAE20F5A5FF368E6ADB67F7713876E2DFEC983C2BC26037E7F2904FC30D275B997E5BD00AC48BD3129CAC6CD2AD67243B533BE1F90E1B8CB6135894A3DBA32496D7041B682A839B1203725EF50ABA2A8D862B9BD2326DBDCFC6B4932F6E626E8D6E1C41A057056BB1B4A11D8D0C25813A61AF67029B28425C8072F086212CF0F6F9F7E431C1C6895F6BC0190E190DCA10A5B83A664C80025799A861ADB73A54AE82B59C593FD17138DA8F4FF92C953CFF5C9472B29A48A74964BA943BCAA1E823B036393E4F6674EB62C2B05D111C0F9270BC925A706252D1EB4AD91EFD2B2B694DF94BF315D9C182D6965D03EB25328B5749AD06922428B65AFD73678C1DA2A7D565B5F61942ADEAC588FE3B3597D01CF3F4F01CFFF83BD2E3184030AEE7C00A1870E6D60A98C32CAF64E4811042F84AA6A13635D78DFA63B511338B0AB71805F5217093CD3907E6A7A8EAF477E715E7084309BBB21D8E3420A865FD3883654D00542085D29C57BA4F5E3D1CAC9E28DE4DC85C3B500C9F618047AD802DD390C990DB061992C72A7C2C259E3B63EC989D2DF139721D8D8CB7F5440F01EEA03A6C4A5FF5EC96F751DB44B4FEBA9C363FE7AB75AE4C62F2F0128B09A0FA2FBDAB3D28584D6ADFFE178D50C1E4C594C91FCD7FF7D27D4EBF68739832CD43872C56EEF9B423D1694B50D04AF971D7A226D065DE80EEDA7D5C3E7E40F3F622F58F2C3BC29A9168CB2F9F97F6B85D9BE9D32D104347897949BA5148FA79327B6B7967FA4781D26D0A173755D015F4A684625FB66F04AF6FF7E5DC6F468C348E406147FC63E742C716BF8DD1F95267BBDD8A04E2EC174514311F9DBDE8811912BD8A8726E0AB9FAEE5DD6F7129A9FEEA83F47BF4F93508940FEB6FEC016F932613E70FCE1D48ADA16250D681F252E32381B01D7C3F6A7030A0E2DA9879368B7EEE4B8CEB9A2E5E355973BEE176598AE9CBC52BA1677AE18F4261B7713086893E55599389CB7FE862EBA29355E031914E0379E582E6A2327170FBD24767B451ECF60DAAB6550531B2E45D3F63FF9D6F19F8B2A81A08D151F20C26045CA517CDE528DFECBD6CFF9084159F95EDBFDE8D83AD7BD1556F4E518B24CDFF2F072B71DDBC41685EB0F46A5701F9D47C464CF6D2836A7CC65D74102452E9F2F8B96BA9CFB2C8B5AAE607E351580E8E2F7E422B8D8B28559D9B0B3CB0AA4272B6ACFFE7E5F6BC0134D416B15809616B9CD721721A72B80CB814DA37C2BE656A6D95EC130BF92231E1F019A96131C07BCDC02B4A6D7C8CC80F9503B63F9D640A71EC1B4287EC3297EF9483427CC1636C657416CDAC8CBFB08D03DBD7DF3155F4308E234882B3EC073C88C937E4EC7F20AB54CB86F0E31222A021D772DACDE8AD6A6BBF8EE34AD44FFB7D92EEBDB77A531A58268BFD255AE3FBD62D5ABA133CEDD0F758E7F71FB50AC6454C0AFEB61E2F07DB5322B7F7D44A6305189EB68F36D0C7E69EEAE5E142D7B810514538FE91B9ACC0011F2AF8171E6540AB7383C52221763CEE49FB4B3E05E4DC1FB919315EE68614D37484F89699C915B565F56CDE5A6F5F12857264F2EB7B07DFFD1E3196A59C50C371F91DB2CF1371234D5F0BEAD34227E9018E68AC10966D77C06A272B403827C7D083B1530DADB5587BD9BC051AE29968216DFAFF52CD98D20A81196973904FD531FA814E60B3E16CFDF39FB0122447C9F436665E35BFFA6270D2930FFE74E0E9C410A9DADDFA17DB141DAE3EB5014E27C2969EA331274F33D1BB0EB2E570D56C88CBC237CBBAAE3488D42CD53D91D0E34E270940476D7AF94B0B79B2A439E911ED0A48BAC981A395CC27AF04E4A63A0E347A390AB809AD62382B9F338E3251D300A10B27F215EA947FB4119460EE0E459BEF87DC41F8E605A90E29C2B9FD0310E3F36BBD9E548045D10B02E602A98DC09ADC5AFEDE055BFA05BFC70BA8316A04FAA6CD71389CE3C687790AF09D5EB7D150E4455B53497EEABC6FAC405A2B7F0886BD03AFCF4646916A8DFEF8A5101318382BF4AD1158BACE6EAEF691765B9FFBD00002A833AA00BD9E8EEE82C30170913F84A2176CCBF8BA3E58030BECFBF4A609DE9A0B2B439629002A06170D18D619A974DF18763DA888F38B58B82BFC00F12D383D065CC2E7A2ED7E3E23F5ABF749AA4329E0A5BEE1ACF8E0C0054BAF2BD6DC986AD6F7BBAEB8C55630B0149D6D3B552A7DEBB1A7ADBD5427DD3F92EEB2BABBE6242927D74F55C6749C33E41304F6C41E9D73180626219D9978A8B3A4630B6EAB5A4AED5C0CEB73501F2C91ACD097F0B52920C04B53E4E1E8798C34FE462665A12EDA90C382FB8671C39EFEE33D530CB829BA4A0D0C584C8682696535CB2E60D831DB4566A531F986FD1602B530F1942ACAD06EDACB5A86A40030433C194814687BBEEB30F4D05DF2EC3F76BE3D852895B0A103A29878ED6EAFED0B93B62AAC655F51A3E5074467FC160573B9B4E417E2DE21230E79F9376A00A33F965B5B2EE1FE49A925AFDBE099DAEF1FFCA8785FC2A0FB423898639AACE39135E07881C3D62E92715AF5E5D73C119A10224F87B20D657A12FEA0389517224538141E80B7243A7BDE0E88CC62AC6FACECE459EE0FE18EF1B320FF11467703B1EF991CE2902258C740A6D07D0933ED159B259C8451E3668081107C05F41F17E96C04B670255F4A9572E2F0791BA4B8BAD3E4288CC63E4383831DEEB1242D2783FAD75C8CADA5ADF47A4D0B58B6E4EC4F10F43D21C5EE74F05EFC085C49E8746F0A9B4E9D07F3A33FBFD447F9BA226EB0740D4FA0FAF25DC9190816D0DEC3E52BFB5E8CCF564893F60FCBED5B76E87104D0D098C5D4CD10B0D0967947A19770A0FD0CA31B09293970DAB719426479AA27EECAE988735E9AB0B631365EC7A14943B161DB599568F40D4C04874ED5FDB4C87EE3CD986C4C597534A9301FB5251AF97A88D4737FEDFBF6FB76946E1014DAD87B5EDBF6E8140857EAF2AB29D7A385A278141C9384CE7A6FFC9FD299C619E052DCC59657D3C56C99F5795A330A4BD01462BB3F1F67136F0504227CFB596A1172B24F50A9A908EBC5EC1140E78DFAE2EDD114530588293CF6E897C40A66257A13CCE86C9331AE30E657571E3660CA729A4EE37166FC85C42AB90FD40BA0C21B5E3958D6716B72B3138EF12E0658AE2A8E9E0BD505AADE50CF2D9E04CCBDABDE9FC465595268E8C6547B6647BD6D4ABE46C1C702BAE2B4E6C7C942672F2BC8D2BA5CD33F8C33D1714E717134089132E263B5242F9003B28164F94235560899F8A40FDEC0DE65AD242172E349EE658ABE19E4D82EA5FB72FFD8CC5A7812FFB4CAC90F2948DA07F2514A3B5DECE6793A53FAF50C58DE24D333C5277F9925B83EC5E59DFAEE19B99709B21CFC3CA59410E166D3283170C96751AAF28A159F5C86199BD5E7E2BF8805A4DF032745E8B7DD01A1E27FB4931E58DA81389DF921DC59BD2D806D136B699A70035C99F5F20435665BA813138AD111978ADED9FABA50BA3FF4D92D9C2CA9B3B1BAAE1BE2FD6147EDB852E8E10D095B18C7AEC7662B5372008D44214F9F042178915D557E87E6F27419476A8C3FEE338EB30DFF18F6B33BE26027A50AF8135781B0423991A72FAFB066E4AC8EB888423FFC8539BA10864ED1A5B108865748EB32D426ABF202F8B44E86B6ACED6AF32E4B603F68AC243E24EED0E4D97D85D0E1EC88EF31BD9240ED34914945C092DB41131991FFC5590A98C57367A6FE605F782E3777F479703D7290C9CE74B716D8D46F83F5EBB024CB24527803CD5F3E397DE4FCA90585211334275E8429C4CE4C68F14D1C2E14E4AC20E1E2698C48625F4FAE127DA950B0F71296C643B96BDE8DA33DB77AA5B372E1C7B81412B4EDC34D4059E7958B2DF207B878E5F0F4D97B0E9A08A6A064B10A8E1C96318EA93F19B0C185A469A273097D5854C41DBA2CBECAA7CE1851E47872DEAC6B991700877EDDB9B70E13D2271929227B6FC7D47D4EF290293C0B8D8A9D1A9659AE9A0CEE841DDEDCD11CABF26270C04A19EF1E2F695DEF543AEF4F081D8841963F80D061AD6973211F6CC009FBDC639462D857487408B9C303B31FE2051CF2AF2781023D810F59BDDE8D01D4DDF1DE33A4D8C0B923A194551028952BD933054D4D3DBB506A341E6677EEA705AB506454BD68E43854830CCF6AB3003A7F218661265734C4325E1D7662F91C1544F579B1A967B173DD01630AE45C4838726F10E571F578F3934CDADF8E18DB0804DB97562FD748CAEF8C2DD6310C704B47C166341020D62FD63113D27C30F5C454E6AC60B9D07DCDB1FA70EA9A387C395B16918114050A69AB6EA3356AAC274CEA949051D3B3793F054FCE15DD52C20ABAFA6BC814867AB7E8207C2A8376B335CF2713727DA8D95F8550C2E4063B4DCA746733FD2555F93A8729365271FB9A5ADB3C66F6D68711147C1DC009F64EDD4CAB03280F050DF6FD7034380CF85A0B6B2883F7D171BFF4955BFED56A63A9203D601D186E30DBB92CBEAA8D0E017F93EBA539D853EDFE3F7E319937A869936C7E8220503D08695E698B552FA82A390ED9DF59B8AF1D290C01E2D9945040AC3B1ED00E7D5BEDF4C20129CDAF42D3D1BF60F1D70517246C6288E9DF8EAB607D1406CD0312A60702E9DD09EF1392FC04621EC44A9AE0E8C07D37069FBC03EDF846920FF3E900B895C71535927B727AAE0D91A66A0902B79F1C4660EE3876F52FAFCFD48155462FD15D4AD35B0132CF0A5A03E4A46AAB8C2BC274F7C0953F545DB0485794ABEBFFB926A6A3B0574AB8A65A5CDD45DE4ED63DD72A0E0F22D28F38901395980D2160CA208EA886A4378F5FC02F95D0CA90C7796BBA73F50E82962807572A24A24861FAAD5A8362A4549A5DEA435CA36A6268FCF9C91C7C8E0369315B89925BC5FA5D92E625822EA7D9FAC32824F672B1528CAD9F407A3D7ADEA2F735723409D5BF5BC9F4A6E6FF2F00D9FF9F9557A2430202644D9F21DC30882F7FFF6DA5E3872C04CC1EAA9EAC8DACF9B3ED8D9A156D1D8EFF8F334C7F5E981C0147A3BEFF5B3827098471704C43898C2C52DA57A49A8624FE49F68D79F3737297919BE2486EC6572947A5E99C4843BAE2AF1E8ECBD0C192A6B8636B0D2850FF3CB7EF2DB7280024F737B93D7E0597A938F1DA9F6EEB0DCBD24E1E8F9D80B097BE116921A7C2CF68C6DF2E34164B12D8075A568F04A27F252A46705FD43B82B51E2E7AFA910104012CC8F28E08809CA5638DC9B723417A590C8B0A11BAC933AD74FAB6568FB3F6033A1A22AE186489A7231BFD3DF6037B573459B41DBE9472C1FEC5462F6FD54CEF3449A4973F4D6A46E7E726391CF46ED5B422216DED5B3C7325328417EBCCB7AB97B8E29B44D0464B0870058998E1F96819BD7EC066049AEE386C8D33A427F1A44ABCB611AB98F68176BC82B2549EFF468F6F16D5BE0662A4C331172E4F6050793947CAC5A245537C26C3758D926244411ECF174A42BE9F2E37323761CDEEDD01B4B40422EB533CB8C52693451E1153FF7C95784A098C5B99A269926077E0EC03DEFC0B43365DBB07609CB35AA57FBBC7D3A745208B613077842ADD7810465F3E7AA6D879BCAB459A924A65A23B007F2AF94C270CF2A21A87568E922D4489A492D2B5758D8B01504310EB12D77684A86DDCFEE66851E15134668DE198E564B6990AC2279F564C6FE72CC32463D0928BEC35CFE3CAD29C9E8772B935A8A4BF9C2EE9FDB53ACEF41CE37A1DF3281C53C74F760D2765496DCC4E8734321E92B568255B426E693A4AF8F8D1959336D650CF2E46E8F064F4AFA5C9EAE3DDF4F22F3AFE8520337DE7B1593366E963EFA092D51B410406E5F2622339D0EB68F4CAD33095E0FA3130319580D642806C3710479253703D7806C0812649B27D9DD012107FD48DE8F275E2A6D4F762183E734332347C951945D3DAEC94E44C8CC9B34B25CD13008C280F5E8AAC71AFE67D304E979608479AE154B95C75507F976077F01EF3C959EE4769B099F3B9CE785E766C73E2D9E7A8A3D1058E62DD450944FC3E9DFF133D81158C35F1D71CC8CD25A2F0785040E6E7C541932238AD623D49147EADBB391911C3127CC1592F479DB82C01CA32A5ABC0B0B58ABF607FEAB909F5294ED0DB9BA0C9BE5FBAECA4AE7DBB0C26B9BC5A44EA76D4A0511818CE298356FBFC818A5E28E9C59A2E35030CC1915098D11455D1FDDE40B118168B9DAE46E4E0F775AE73CBC129E1BE517A2BC1AE5B008D8E6F2B3A2E9E0304789BE6F6F4D2150624B5E3418CB5C07BACE25E3ABE0D6A6D7EA84FD8DEE0171C7F4B0D892C0CCD6D48E4ED39596D996E5DE20D983B4F6361DB8A5B3912DA9FFBE94100A87514EBCE55368D50A5439B6859461A24379FDF63A1F07F3434B534C38D7A783AED6E148F2E3DBC957C861233B016DF0D3C00611889FC87ECEF922E5677A4DB2AA8D9E5F7661C8C6B117CB527E8B7E5CC657CFDFBD8082A94A696810C9B9FC46743A69D87F8B1565208A18236529F97A456993BA5F0241096FC2E15A5DA7884D05AD6090B527B2AFE98564C8F3AF51F73ED60FD66D1EEA81EC414B4C7D2ADA5544F351AE2E1799286E47248E3343AD009DD1F83DD3DF153C71F0F3DB30ECC48E94336914AA05FA65546CCCBE37B08D07DCE3962050C71130D2F90986E950A0A5EFED7A5028D123F79F60DB862C8BC2FC506D9C1DD3896BFDC5FD9CD742D4D0E189A8A26AF8D24B562257BFAB5720FA720A9940F6DA86F5FCEC3F0146339CDBFACFFBD71FF81C2361DDE8D8663FF368A05FE92D1F4927C0ADAA3DD0BB3AF14E9D1D970E65DD23EFD91F34D8F2A38D3724623E408A9D413A33EF12C2E41A346C9649F8F8ED0AE645BC51B755AFDEF098FA1F55BEC642526DA7649FCF727EBE265896F147BC7D0677F1AFCE38F62D6ADAE0FD58EC1357B439C4C353454F3B6E98B9B7A309A0D751119713E182ECFFB9C49E12724CFF878258DFA65CAE5FC91DCE36F0FC3AE8E46F68555B8810DD52B8DDC804D67B57B5BA133EE9EF2EF25CAFEA4FFFD36DB1E65A8DFC67C5F0F8F70563ABCF40229ABEB176DBEE079AC395BFC2F8D1428D24F24AECBB0C6A7D6F754B067FDC8DB8EDCB3B5098C8BDB41F1EE87CDF0E3B0EB45319EBDA114C1E8AC844BC4EE6ABD22F4F8F49505A5FDE7BBA8DEB6616A7E9549FE5F4B52947047134DDB30EE64837892C69537DC682F3FBCD54C652EBCA60809F9739209F92276BDA0E2998960E170221765471B7753E18A57A2C13290FE267DCA4FBEB8233FE4B4328FD2419F4D8311B2494A8EA741DDD0B886EEACDB8947F693F51F019896993EC98C063E74AAF0C0E8A036B16328EB9ABD8BC3E615DB8C62092D1687DFAF0BC92054E65CCB179381AE25DA099581269FF003F5F6AFE40F9476909AF99D56383E7F4FED73E553F86FF419CE1F54C248DD3F03F1F0ABAA823EF7659CD344662FEDA6198AB529B21DD23B16044B8E49EE10BD6FE67A704EC8CA839A1410DE51299E7C22772FD766C480A3DC62B777018168A743B9B360FCFA2E80D89E029BF6BD726C45E50289C3AA70D068AFEFD8FAB235FF3AD1915D18C71751253581B07FCFDCFFFA84CC0911F5DA355D83E46C9BD8D1E7773AADF3492C9B60AFCE56CD3069CD096B7D06CD39D7440246D9104F3C5624C11092635BF4C9015216EFF227960AE266B0E3F308A21E0BBAE77E1D383AFA13F86D8F00B2738F12C64E7A8E7A658915922F9C66D0547885342C0C13CAA5232DC5AE81AD150EE8AA2CF5D426509DBFBDB1A611BB494B42131E8E59376425770B81E02FF8E656DB91FB323FDDE76534CBCC5CA7AC41946041C4F43A2C39A7D10DB16529B0863B46184C6B6646109D5A124E41F1D9774CD37BE959D3D2CA93125686BB9489145E72D8AA750EE5762F2E75935E8C5195AC9BDE13F8EDCBA6AD52CB2E7C9C1FFB1B0DCCED4D27ACFC75BB0BEA98A01796108FE5A87476E7F417994A381C30B3DAE08394B2DA7C3B26F40B839C53C322FC4B02BB35F791027C58833D89D1069696F368D5224609217F4ADE9A5C8E1E855E7FDC30B02632EBE5A2ED58E6F67F4135E1B2EC184F2CDE7A92D6FD905F324B2DED32C94726D7C599D0C8000C5F8DFD0E7296FA33906A79E5B551D897B682084C97262A55666FCA6409EB7D0590C20DCFB6A8C02C25EA2A7A36FCF8566EEC7460B4E936EAF85287723FBBDA4A81B78CB38F217ADD0B94918CD9BFCF9CDCEBCB859E0A21D50A7C9408497336FEA837CAA3A73CD5309B55B9344A23CE10695AC6BDE5ED43325A9FF23EEFB6F69632694E34D8FE82D8636062FB6BB5A1DD09BA9A8664AD14DBB3C9FE6CCDEA64707AD9CB0DE0404BF1E7D30847B1D52525B5096B6A5615F4C368ADCA40582DD44B6F81443F8A2AEB7DF31EF2640C68213972C124D75D118A3EF24FD9C62A2B7F9B26E7745F52F4F7BA54E132063401B43E32E5F1772A16590AB49D79E86FF73FD4EF411A85B0727E37F15060D861F212497CE3C13B2E66656638FDF5823820F603DDE5D5645977CEE18C38B96208022EF7B6277A97E91545DA428BE13613AE93FFD1A042E8D7EA14BA9A1FB6ED199E13B48F3F9776F7CE713474285E216DF04C93B0111B2D09438DF1F0421A4EE8C65489A3C068AB3D91B59B88705079CA284C00F4B52D42B100C3E44BB014D0488DEBC4A0F1CA555A0E06818CDA36ADA72522893CA0D53E6E3EC51FB941EFA2B610C4FEF60A566EC95D39FB920DCFD2D34D53FF10FA315CE9A6CBA640105A7B9C7CD64CB0C794555DE514E991AFE6A3CBDBEFBD27E2F4FF5EE3B94382DBBDF11B0002DD01C8B8D278E69B3FBA6834FF1A54BD177694229EA7AB532844872C75C1A35B43B2BF2EE98CA00FD2FF3530B7DD3D0192B9274E0B917F81796628C71463E6ADA7B1A87A89F7173AB212964100C250A1540C1E5F929D8D1FAE0F865E2140273B4847E54B675B17443A22A50482F37D076AD0CCFFE2CDB78F9D535C23F0D7A94551B8DEF96D7AE2713D267D647BC6E34DF4A1C70D5341FA789BE9F0F6A8C46554F0B60558E2FA496B768323F4C2270F0251BA8EB77F2F68B73B522A62DE725A7BAC68642282E197DAABAF38DD1E3F6860AD1B0EE3BE7D7EDFDF1E2D92794E8A046491926BF8244B28B1576D18B5CB7B38F52271CBB0A5E72E5B36570802B88F8FEFF196554BFEA812D6B2967911A7D26084F9BF6D9ACB812680D57B8ABDA5BF409266D237F7B486D53E1D896CCB43020D5F33ED8768CA82FBAF310A7BE74DBCDDD718D75E9F53B5E9174162B37E9348F500BE129DA0193FE04D22481C62FFA382E9C9FC54C2ECA0DF185B51ABC7726E82CB58D83AE1BD03B98DD2DB58DDF7FC15BEBC1EA00D9B214EB7D06E829AADE24B53CF64AC1A2433079546A008987B49F1B8D48F21A4C333C9B01B6BF0DFC324B451CB4E664CA194FFD72CDAF4156DC19C1F4D92E333786E07A096832FFC28FCB10D4C78564FB375C813128DB86ADFB4E87EA6A8B1AA3963831C02D9AFA559BCDE063A2D9BF4D46BA2F4A9B18F9FF830595D09FFDBC6C74F0CBC219EEC5A494DC51AD60B7FF794617B31713A92F5C73F73B1470B202463B5529391FE25DAC6B845BF8B08341B0F9B118A663AE5ED95C028FF989514D2F5AA46175FCB67C7C08D4E0FF71B4D85929311A60557919200204F2A9799268C2254F6AC8EEB7BC58BC63A3A30FC8988BA3FDBA05AF4148101ABA07CDEB263B6BC4D7628F337FF1A40FD745978E6E4B6C8A5A628A03D1B1E222999B3B7F9B19D370FE96A105D2D04F41177322F6DFDF910C199E058E6E908C3ACFA7F4CA6518DC04B577564CEB4B0D462AF05CA79D3AB44F8A54D1682D680C72BA531A0A300AED952B50131C7E47AE16FBBB239A125928C49071D967C46F220F1DFFD91B8A9585FA0342B1D6750AD119C03785DA1924A91C3525225EBF8FB3AB3B952B94B955FCC8870EFB85C0D301F95F5A43E2780E8C180355FFEAED8F7AA7F451F399FAC21253EE1EACBA2E74324910BB8A51F6D3DE24ACAE580CD44B746AC67B22963575E3E82FFAD1751485A37A6614C2096EAE4DD3D04CDE6E57831D9A4DFD0889EEC877A456CFD6EC554984816F7D99D4A7521EE68BC9AF212736B4788241D097B2B3C4F866D55504DE5090EF80C8002F63EBB82E1F0399CBDBDED3A0B37E1FA2A0C5B47C177453339A6E73957EF80DE43B3CD1A27D34ECBA23C1EAE368A8D05C5B2A2E04A349F9A15EB3C29DD1A6A878A1572307343177CC95A60F7B01DBF5C29896167E30FF2B233AB16954DC199CEBFC5B4C4C1B29C5828549172EDAD02208802E6B326A07789B6C630744B328615C68787AD626169ACB7BE55FB8831D6FB885CE42644964F2340DEC25782D39381735D692385FA51814BA238BADAA84373E499BCF6F7197D6AB0C5E44F48808BF75801457515532A697DAAE7AD291514868DC073342D67734EB3209F81A5E25D5047FC1DD39DDAFA8B1F55155AEA1A8EA095498962497EA11C6892719FA89E8EA39641C2FF1449BA9ACCE83BCCC6DE6910B2E0CAB3EA4C4CE03DF60FA2CE312FD1162B94FEFD65EAAB35927F81A9F4FC412E79D5A3A90BD489116E8DBDCE4FE729F56872B6A31B92D2AB5D78924FD6934B922219821CAB8744EC8B6907591D0A35A4DF0972D7DFBEFF5AE33E3B112DAD16C243E3C4C45352A2CAAB8E120FC143DAA02965B2FF43A5BA6ABBA7678C7DED38C3A066083E8264C9D78B8C83861D32D5019C0EECA1BC1DBAC422F81A57B9E43A03AB1657CD20B896BD7244866C3B88192BDD9720C5119ED59225E632C6D9746FE4E854C78D43965C2D97F76E06003E9B7FBAEC7C1C853E278EF992D1E70A3982E9046FA98DF8856E84874B4DF13635F156ADFC9170897B0B956AA746B6005CD349F69740F81D9323E91C6C6B4F737C9F5C814ABC24B46B133545A4D5087C4A640DF47641896F744066FD80E9781EB7738B5CD84EBED5BDF2F71453FCB81FD491B93A3959CA4B6946D0035783073AEA730E506459979333388C76EE85EC22D1F2CF694F73E79C007E61746CDB6FC99BF6AF54327BF4308AEAF99A03AB4F5EFA3B0B3CB242FC2386C649113A1D1BB44DC64A2B9B3F625482CCE1368BEBCC2BB1D600758A4235AE32395FE23CCDC0696549BB9F39EA928FB6797EFD9C79460CCD846D0EAE54F7AB04ABE0E8C7D66CE3ADC1733963CAC9D0401486653201297C588F99721873907E88B16EAF73B2094E47A3BAFCC5907EE7C8E213EBFAA836121A6BFF67813EF387E3104528124F70CB6D306F9ED4882EE97B7C855D048A01D7F450BD6407F1F4AF8818E16A2408B87F6B830BFE9422EEA56AD2273A06EE54C9550912D99931F3A4AA2FFFB1DFC43962B1BD1CA2B129E43E895D9D00812FF0A28C418981F7405CA38D60DF4DC5B4CA9F6F6A59603BB5D5794DA0D19A86CA9C516651F4A8E675CF0F2A56061F5E4CC9F59B0FB43A0E8E63CFAE6CC195BAF1934C750E926A88C86CD5BE265CF5EA7CA60AD116E47B7BF74297BCB7BA47ACB7AE01B75DD9EEC97861D4D1BE17B9B49F4F795BC4B360A44FDD9A9E5728D7D6DF1F0EDEA2428133F6F01031251A58127DEB79226B1A117187376817356B8FB0D6B3D8E60D7A899E6EC1A25732FEB9A6313A949A4DC48FFF48F140169EAED349DB2DD187C4B72A47497FED2926055DB4EEC6ECE7EA4771521AFC8FA44223FBA8A4815E0C113D06146DB31CB2337A329B609096FE239990967EA1E39B70403A9A64DBBFA11791AA0106EED0C6439BB7E7F223189511C912A6B16E82E9AE8719A71DDE138FFCFFBC12E05ACCB7A5606EA3EB65D5E19E36065F9D5DFFC62F7359C7012CED29BE16BCF06E113F476C0BFB2D42873EDD3ACC59AAFB2D7F7D10756E18110334597C5970B074B22548959C17B193AB270718D6293949DB326A81A543B415DEF9FFEAECD47B01B2168E9235290F2CF9AC8C9247D96491A9AEE5820768C199CA0CE861A0CEF6284A1812AFFE1881187130608FD9FC125382D1BD7642CD442E494A48D53DDB51FB723AD0FCACC0059E7C1A34D526DF365964A34E007C918CFC751C1479C5F3F15AEB1546B67CB93B64E4C214CF62392208B14A5DE76435632B23AE8F26EC7F9CD5CC4B2DC7A39301C02E9BD41AB0BED60FB29777B45AA46F9D1045135EDFCA478EEBF0BC1117882A20935B4926D65C9D343C3714ECCAC6ECD6324F714D2C7FBAF405DCE58292FAC41EA9722C90AEFEA88474D060FBA160957BE5E4CDEED127FC45230E0E1281476AFBBF42C9F38E488E2458646DE8816EEE4F303BE512C86A6EA5EACFB55E42805495F02C83C28CC5CD8C4ED7F363AF4EA550CEEDD4236F8A9A2FE2277AEE681D0C2544CC049965C8AF33839EF224D730BAA9BB4A09F0C6BC9241AA7B36F5ED16410BA92014FB6C898F0F6FD6E814A1079167B97F31666E09EEDB563B24EA21C1D37B125C209032B1C7D5FC2AED114E6D263CE9C055C4B1417BF0B3C19C6170344E8F8D66749E2DC4451ADA2F563FDF08872DA9E095005B21AD6DBF39A8DC34BA432E10E826C4535901928E01C357C0BB67E6EB41262A12458EFD3FA8125506A2AAD851963F9B559B4847786899308B504B395479FB4192023D074B6E651B289248578674F3B8370112DC1CF9383261D5384F2B270F56422F1837B87570F801A2823D1BE1F04E5BBEAD572AA332B4D23041ECB3CF0DCA9231A3730C3B936C1A87AB5CAB675B3C0A3B9F066544CBF6719EE0DD94CD72D08C0358BC9D9FF57E6E9EB62AF765ECCC6E942D59F1CEB7F69DED1B04AB41450E2943FBF599731A3D166955819FE46AED1598DDEE99B115C4E4F439CB1A49FF284A24F9CAB757ADCE3F4DE39E6EA5CC7781F1428DDF78FDBA47E91C96C7361B37907697D191BD97F212E87E58D0A8A4CABBDEC12C7F34E2609EE8C5095FE9F6DAB57F8DB6A0933E1C94746BFD41D0A155F769A527E11B0C90060F0E9077349F1AC8FC58C2E4BD1F1A7EEE46FB1933D3CE2C6A0D7604253DE400B0FC8DC38C8023CDB7D3774EAC0CE09814DF8D17D887EBF9B594719F7509FF484ACB6EF83C19CC944B3BD4D2A753EC2D91FC5E5DE54610EF7875F561CF7A4EB4F7418F84BA90A96137D211B4F2344FE93F77D770E14690C1F897A5FF0F7380985F195B992AB916FBA1D357F613408D28A2CFF303DD55BE6D7A900E336DE530C551CDB91AEB53B7DB1886E0C9FAD001BD3148679483D1CCEDBA2DDFE9540E8E2B9078C8F970FE022F15FD48E8405F381976F2FA7B13E576397FB782FB00500E5261B40E05AE639C49A1DFF0C67BBA0491F7B36AFD7F862C8EE3E88D8EDE485B7943B982DC7CBBABF3CEBF97273B4E14701F15CC3932FF60EA399898B901E9B083093BEF000B95B89B679C96719A2A402773682D76526C0E178F9D69CD87ADF3CF11749E89FBD46286FD04A2592D786867A1677A10F7F8853DAA30A0DE1ED9A77951B27680F774BCDD5452312A057771B0E39BC0F53ACA64E72E0108AE1C7D8FFECBB4FDE13DB1407E49C2E9A7E90C5D0844A026FC2C963D6D4B7865A2D5F8F48F796269D8FD6405C9325BE74DEF775AD451C1C5E231F3EE0481241095944F51E4BD5D7529A6542FFF7E6F894B32826D697C6A365084899DABC0EB02F88B8833556E521F45B37B36672EA7BAC0C5A523B1B1E4F4CB36F95360984DAD9501D553A9E74848D9727A0AC7470025356F155370A26E3766EEC77D44ADCDB3BF8956B009E085413E980CC78B1AA9A4D98877240B07DD6ABBF292C35C78082CB6E0F2105B403AC8083DA76A49D45251EF5AB2E0E9CE5FB45D841CA1BC84FF32656C6C25EA8FF58A5EFC8509EA8AD535D5430AE0EE16CC00F6725306BB5CE07D25C5EE03D09F0D51E949AF41829B2FAFDC979275AB7AD2FD9224E1E684EE8BCB42112BD221CD4C71A210BA09CF8E6028880D6A7EAFEA3F31E7E5B4FDE8CFADC482A2677C18D7DC6A7A233590E66F0E4D9AC14CF0DA92997226522583A3111C2D5D740C08E09539EBFA4CDBE8BA124B4C9F5191AEACFEAA571DE5DA5EFD075667E0CD25AC825F48706312657708502FA8357CC989A918CA09B87EFB789703EB2C372EDBCF097B4D24919CB0994E0A3CD148051D94956D6D94AA568079ED9D4C97D24BDCF694E1864C916601475590273F536A25637708AF345124C5F3B98BAC857ADA66906B48B5F46566E2FB236F34B93A6614AAFEB0B60FDA1E793AA65DB44B655E974A9D15430437D5436C553755EF99A38EA76E8B97B809521687F2788BB35BF58350BEBF96DCE0E9D75BAE559C2A5496171545E85834245BB005E53A203756B5FD3AE93B3F834534AFF3E81725FC21F9F0EF26C53BAD6A56DB0A8CB6FCB42FB77E91F0499955501089A4B4E5F24BB1625E1BBB0EA8BFAD262162F19ABDD7097ECC7EB00ABA70A8097617764D13F0FEC7564C2BEF570B0D83DC0DDD98A5F9A7CDC30A2C4B16FC2BD2385195E010DC6D9C4A64D7FCBE0DD62D03230A7CBD7E5670118883E0AC7B02D2125932C7AE1FD2690789815E70E37BE000EBDA6C9B883E12C436319782028C4A1F54305A3F039A972A02B21EB225B639B7440D5E0F89E997EAE8C067A528A86F1540A7D921B07CAD50ABA3D76F1CBAF1AF92836BD7510D8082A67CE4439B2403E8195CF1EF24A1FB456D9902B934280F5D9FC4BB5AE61CF5EF079B38949AE692BA660D51C9E80BE67B7A21321C1A80A044FEE4D02F7210FCCCA538E0C79BF4BF97EB74E170A2A4BA655AE4BC3644592598AF8A6970160B411F9FF46E44859AB16663E33D350C85394B8436FFDFAEB970DAE875601D03947FABDDDB15888051C44C304A08037D87C4D2A97B1EC0B0AC9AE5639896D41F97F225E8638096293AEBA711912B5ED7E283CC863FFEF73EB874CC8D6B2ACE1F61042631D62EB8EF231E29F85319B35DF95A112FC46D12CCD902AFAD44346EC779C9A512AF7A26B6E145C2DC2B0D930C2C4C9DEB0B5AB132AE6AFD862046FEECA42222D5754774C8479FB6EA0BB11B671BCFDC5F26F8DF7E2FAC6F6F7E0A1193026A6E5829141D4C33D92A7D18E2BD656623CF44FDC7DB970CB939DE0B451202FD801A0D2BC08E8A6220AF545A10696FC3B7456D24FD1BF7FA22907EAD1B47D31596210808638F1E222FDF5D280834332FB86DE0BC8171D248278C0012FC960A48E91B1CF71D38D76452807081B84F0A40510F83A3D9FF3B8F95D09CAC02D4B94891D98D9A76C2F911E74AFDC0F1F93589D4CF4ED01E4F121AC9FB1577B870392EF770E06DE50287129EFF9957E1EDAABFC51B1E9E2FA4D1EC5AF802EAAE9AE0AE0FFC40706B37B6EBCD8F82C71E98183AD8F7B0DBF39AE8B47748DC63957133AAD67C0A67A74137E2C647C1CC21BC46CDCDB14AD0EFE809FAC48AD87228E94490B9473CBC7FF2569527DD4365C89C76D045315CE173F485FAFC5539AAE9F95F4CA01224C95826E69607A93ADBD996C5D13DF06A16E6EF9474B8E70132B75FE99DC9B1AF567A3E80A9DB8973D9FC5D4AED52A436ABA9C7B677337C752FCE4A691E99D190AED88F3FE0722E37F7355746C011163ED54B59118CE60B646EC58402B67746FB38E52B07E9FB5196D793CFF87D39BA4124EDB7EF559CF7CD0B197641709620F85E0AAE4C74B4B32BD940DDA3438C2D465EE017BDED695C76E484954BE74307CA2D20F6E8F00E43E33CAD74B8769C0E720CCE909800B559916E99BC22A972BCE75498554B2EF3E04520D8E3051422AAA370DEB93BF6F138A6E77D190C101954A9081FD1813EC9D534B988CBE74AE66E2C4FDE1C558B5651E52FCF48BFDFA24E9C8D8AF680E4083CBB051632901C0609E9B7108711474544FA5E5EA455B3027F060749FA0D6CB1DE7816C3266F8A5DD6E8391554D14BACE4BB7E91CD917B6777EECF2EBF8C2D18AFE5CE5E0FE34C8152261A4A49463A8012646C8FA3FC1AC6C2B2D737F080FEACD04105B55DE8339570635E85792019BC68B2B49687309A5FCA4B9962429FC9062AC184A1125A9CA12A98A5CE7C581FC5E0F7F3B902ADB370BDC2B2CA543AAD51DA390F01B133C5FFFED9731F09803554E078DBC2A70E09A84EB97A4CB23F76A48A9D1FA939157A8384DF7067FACBDF33494027C9E383C313C346380F2C2D9A43CD4717605DE50937FBD2C65F6740347296B7F704B45F8AB09B332EBFE18852DC78F374ED6D08DBCD6287AFEFB78D25D6174F4129EDA6069197BA432C796C54FAAEBB5C44D12E47B4CBAB41CBBA3F7CAE6D08CF5904329D9307E6C53FBAD6A61D5AA0538A1965432BA449C8CFD29ADD08834E3D16BEB0296043BAE56AFE4F6A3D229A3BD0F60409B7CEA8882175B4985B57AE169AE99366F3BD809BE04032714986EBF27F03220C6691DBD3953883C0855874A4CBBBC858445E0750B062EF1EB6A8EDA087C1CF39B4F2AACA2347C1EE6FB2F6323F6C86539BF93E6DC80ABC80F946B86F258DB11EBEA298475EB809AE861608F7E80CD7C5D4A6F2F4CBDAB4750AB2B2CE48634FFC732CF8C5BA8EB687BAE6F9D542A49A00C90BFDE6BEAC27C8842E5C44DAAC613FF0DC0001F2FACE1007C0C52A878377762C4D36660D89CDE4E43BC12F224F4B35CEE22449909F625DE86185DEAF772D1D26268099D268DE8253C67258687EC7AB52660462188AEDC658209F7A1ED4C3000C2DFC230509C6A679CC2E25D383C7F7F2345F2E403B5C9A7545D7B8F90FE6116458C3CAF6528EC29AD00BC1CE94C6FC06952946219F0B65F5D89119DD435215395D6415C4F0C635BF45AA5FB00F34983D42B362E1B3EF302994F958D6022F1119C617E892ACDCCC91DFA76681308A73F78F0C7FED26A2DCE31E926BF18045494E5F555E8C8EFB0F813F1751F152AD006E2238C41C5F405196534B58D168BEB5F459356ADB292E60EDACA224456BECD6AF8379B456EDD226C846CDF8BF960844E2729085658DD340C612B05CE685E18950DED5DA838132D119EE95C074CA935B4BEF472A4681F093AF653E08A2103E41E2ECF60BA2B881CE901406E531E82BD35136131589A20EB119FBB6E17181AD18613DCC42612FC606C000CED5B7B7B47C9D1175C0D3752AA6D9CCF35144BAF53A9AB5DB8340B5178A9763079DDE8783CFA55D44B0BC64483F8ACCA592B00B58CEDCAB6530FB2DA281FA0BCB8FFFE5CC60B707E25220CBEB622FDEDC39B57F04F37835FF59EC1FC04A57CA41BD977EFBD54EF1B694527A0FAA114784228B7A2167B7FCA3F0EC5606778B87DBC6A54FD8786C36BA1D20907FD5A35E470DF1AAA4F218762EAEBCC66E919158D1AEDE3DF555828419D06E9AF47C159DF1811818A37CE2A1BE9F8CE61FC7FDED733FA5692437E7636309BA2A5814A05EE4296C9FFF11853429181291719087F6086413CA9FAB27556D578D4DE41EDD45B3F5204EEEEC88859236D3C60448CC33C5132BD06D3995FE3EECA16E108FC8BB06B1DC7DDA899592C808BE979C44CF5E25404B6626623B6810D75EE4F45DFB66F836E4761B7996CAEBF2BC4C4CF8ACB7E9F827927A034F92FD39B5D03E5FA0A3D7AA2F15B20F9C241846312ECAA9093C654DD1C03DE72E6612A081E2FE93792ED92B944F94DAF817B1B4111C815124126619E1607B5F817ADCFF1FA38EE2522500E89C0D6C9C759239C13813BE73A5874C361AC4E688954B012E3266F5AB259465B4F597CB063559FBF10934F6A67BE3152E7E29FD02A5DD3166F9CCCBFB99D2AA9F27BD1BD2E0F4E128306CDA5A954771C632BE3814E5167C67A9A8F8056FDC7318A00F9E68F89A00435715E14914E2297B0863494FCD6E84F71444503DF3D088D05872602A793524AC715C098BAC1806D94FD19E49C743A544EAA0A62A3DB1B9971B734B0E3A50D966828244A172F6ED128394E1731756D069A90749A785CA24EA8B8915B5E55AA54785C2DDE4EF04328B16F324C45502BA92F1AFC27F258F7D01FE6DF1BCD46C4372E717A708D5A7409BE6C62C39E13041FB088FB5995F85D404839DC581A5AC51A364B8685048ABFA279F04DC436F6CB56551FCB93A9E467878155802DA1CA1E3DF2D8B4E505F91306B0888E7232E502C843748948734D9390862714257349EC6CD86618E03E08A7F26694F360772F8E375B924F8D4F3358526F4CD518EF1BBD81424D79E68E03C1B1F6FDC63AED0722BB1995C4C69B98C849FD26FE4B8F6E4480FD1511DD60FD6A8CDFDEACE471C07622C5A1B6482069FDFC4DD455736D38F58A3159191A0B8D5CC21CBAD32E0B571560517612C24A77760C10DE903C3B26D6C80750CBE52FBCAA5AF8B59F2A32405D305AC00D71599EE1757591CE816F4A7D1A7A949789E9944177148506FF99FC0A69B621FE2D0CC724479C3B8918AA1CA1420E33E6BAF2D85FBC91BFE35316E4343F171006111EAAECFB7DA1CA04790409352D256E816FE9CE32AC3E619D6DACCE84AFAB7B1804C4987B940AE6800FFB3ADC1F528638139306B9F5EEAE6877148F952B0B89CFBB49B143A090A5F73C8475F94CB95ADA1AE53A5575460A36E1D6D7E3116846662FD9D92C52B756F15C87FF79399F9D94E922747B5DA00D35E53E7EBADD5C12CDCC95F01134F0181AD39DBBADBC0006A329058B96BB938C4C1F6B91792537D0DF69048C871EF3F4DA35C826024786EC620569EA784BA4D44710EEA573D02A1E08845EBA141EFCA63F89EC35BC5B742420FCB247986096CD9295E410887C79547FB8373DC3DBEF6930E7321C954C53B7631982935FF3507AA733EFC846AB8DA6C7AB003C199C1EB4DE19149003CA11AFF3A7130493D0225A7E3521FF5AC41A967313C6989AA63E130785FD2E82093B9A03CFD56B695C91755C8D95AA656ABA29D58D95F5E441378B8B035F13C9520E0F78FC8FF7895079548EB6D9711CFE3C282387749900C6AC92BB5E918A21133C97D921719CDFCF91ED7DF8B58AC9CB723E55E1CD20F0B0329C79BAFA12FCC74338F7EBFCD1A195F70D5F535675CC8F7957BED8231EDDC88263432368406172E6EC49F83E92D80E98799F22A93122CF943FF42A1C9256C820BA4FD8550E4DEFA03FF70C26547844024BE3E7B0C20033C9860EC04142C6B5C281F11964B707FB50574072ECDD22BDB532CF8A0C5F83A3BDD658A3005ECD6D318A7571491B7C0F923B4C9D63E58F753BC31400E2443153C3E2588FAD45A7CF2BD8D12564BA4E23A3E08CBD33549381F51A1C2994A9C0044E173432A9FAEE2276E0A99CB9F9933B0B04F38E02B2C66B2D51746061556DE3EC14BCD9216CBD86DDCDCF83C4A7747CBFAAA8A434B6B63DF035D95CA935FCDBC1CCC019D054EB4CA97D908D2BA192053E07B7B96C6EF049F5CA67492B7A4602FD9DCC6318DBB378695844D7DD59812B4AE784595BF449AA60E31ED52239F4E847E9EAA0FAEC9692942745E46BA6345DF453A42187D7F210C08D505593A40557F377FCE2A046016DD983A91F0AB4F3424B8EEF5EE7A07950E194927B946D0EE875D2918B7F20D52B2119F298F5578ED37CBEC97436B727DEB78A4ED7B96E3A92DD91DF95B8B4DF145A452F5F46F715301E55302E44A29EF5BD52921F1AE4F214DAEDC4210C8EDDA7717504791386E3ED4924FB185EFFFEDAADF166CE2620C606C2B5194ECCC9CEDFC4F0846E6354F21CDE7BCC36DB158CB54FE8C08635B529F6BE5A12A07AFB4354C8FDCA2872EF4727BBC24BE79F11C5500C6A98CDF142925BE641F45B5AC43A72F7B634EADB6017FB5EDB1ABB60865CD17C632D5673A166B489FA7955F34BDCC3CAA44CA2E717988576A4BB766C793975F26A2F1EF75A4337DD722864B8E39A93BE721520679BB1CB19ECF178989F70156E74C8ACA01D8BB80C8B759FBA4D67E7B6A07AE2C443524FF22F21B0CFEB4A116E2AA8CF31AD190AA57C5B132682DBAE2C3D44B8935546BE5316B54E2817094E5DCD57BE92EEE8F2D8C625B19E3E95F542EB563A0709E389B0E3C3B3CF1D2E04A3EDDBE5FD9742E06A8AF9B15674A38F00179A8DDC5EE7FC1D2055001FFDFDAF9F99AA46DAE976D864E2AB9E9D307AA8750AD4CBF0FD5F60027AE18E2920C2C2461DB60CD8A5A20FB025D2DCF2A886D881D5DB94BC6022742BA29F72523D971CC3E220BB4D384B566AEEB18EDB8E19CA456072F72ED4889F4313C773C53D648ADBF53CF458C04523A3EA6B67C6F332EC55064A8FED1EC157F4E478004072C74F4C2E315C6F466356170BA9D7534EE8FAB91E8BE604DFC80CA8CCDE318A92C746F8B5A02794F880F3451E1DA194C441DC2383949E42F8E4ADBAF510FD786E05A2D31DCAE89D2A48AC2B0BBE48EFE80F06A00BCD320A7205A780C2CF0B8673F3A475C969E264A110A38F96DBE9676CFEC2935BADD0D3BCB576ACCEF3A039A07139081235AB1C1C38C558DC22192E292BED135102B0D4353840B297C13CDE6878192AA110C7BC15EF614F81CFD7D9F5CCAD72F646F579519653823FD161961F4E1895D9000D4CFCD103AE4F907EB9E120E39262C4256905A8F04A12CE372C91F1085512C525D93DBD4E01ECCE9177AFDB3A64E119A65DE3308DAE653A4DBA679D16883B4AC95BEEC48AF011161B01B12E91B4DAE4E3BA8BC9185C6BEAB06F9FFBE1DF77572582D164DAB336A0A3F2406E840B045BF5CA1DD7BEB9836D037D24DC5658F0FE9E67869AF72EEF68265280F792814901416C38FFD5C258DF1EB07CDEEDC579C2E792964680814205EE95BCC395A4D2EAD9278097003A3E26C11890C5E9165BB940EE9CDCE813AAF763E2742DB90C3E9953AC75F36121499FFEFB881EDF4405896CB74A228BE0706CA0F117598F2121DBE2434CB51C0BA01EA7E4A3CC2C37C24EDD53C2C3683A0C5A6EC17B66B5914366C24AAD9CBCC6012DE9C1E05996E7CF33B7392EA77E6E6068A903FBFB3E76016C4FB4712449FA5A725B51F070BC7B92F5059E729948CB2371DD40EDC4F467DDDB52F55F2303D5F70DB3AB6D346A8825D90BA6BF77E12CBB409E71056DF1A76BF310F5559FD6C333E174C6D52F0D5028BBA9BFD2795DCFC9AB3D794D287ECDAC2C649CF867A67FFC16801565675A1B30852C1368AD4742BEC05FE382815A3D5745EFC55123DDF427A1488EB39B63F10207BD9E59628065C557F3E703E29CD5772BB3CEC6C5BF0E645816587EB6F2646B8F002E7AC1EAC592CDFB28C2B72FF2CF988D56B8925211A0E6AA05A8BE7901D0D5DDD0897B6335D3C62FB9E989B6B41ED495E33D619C6CE9EC8D1F5E00BF816E999555FD00FAC913F3CB9A8FA8A5E435D15F680FBCFE135CEF35980CC814721DAF3856C85A304041935AEC99221735592820C5EA5A184C750E08DA8F5486C8189E71B3FD06E653C379B43FD2A408A1C44B8DDDD0A3DC8894997024103D57BF349D6FC97DC8C7461726369BA09DD4D346858C93EA6E57D3D44A89653AC92E7A858DA2AB55CF702CCE41093AB5A3B0A3E55D88DF4FAF14171C1D5538C3945BD5A2A18655C4101E325AC75E6BE574C5A44C44EFBD691E579AF507B285EC1E90F9AE267AB4C2430945E553CAEC3310B82E5BA7BDC55E89FF535108D52A4C248B0A52622C050D2042A17F1CB14D52D492F2D81A35CC7BE5E01EF5272B24C48F4949CDD021D828232105F24227600DDA76FE37F55E6F00190EE4A61065B66D4CFC96BDB28A818BD57A833404772770C12E8960F03AE7F23C8D26859987BE9F9C487C7C6C9C57B08ECA8EEE397D92EB01EC75E9B5DC2158AE2D8CD00BE4714CF6D00459F9EEB9EF0DC69FAC4123B2128F5228FD4BD62243C73B4CF2A5A7268F3845A5D033B483057B11D5F7A3B75694DD9166CBABCAB9F52266F4E7CD3103C453D34928214190AFD83BCA1583FE9159869761E55CB6A9C171DD1C3AF6FAAF83CF4451376F47DF588906AE4B3DF8BCBCDED4E3A674A20AC068954A41D288C5C293D248DA9F7240CB8CEFDA6979E6F4197D237CA06374F52B8199E1E10F605C9755449DE89FF18ACBBFDF863CE1A214DC2716F46042A121DBA8A8257787EDEFFBAF08AE4FDE81A4D14A4A32B7250B4242A74ECAB27C1B48ED953F9AC5C0C888A4DF516FCEA9553FFCCEA6007EE95EEF4A7E99CAEBFF9A51996E0A985B146BA7E4161D393B4A32588F81FF7CA04C14AD451FAD2631E929202D22CEC48F48F61012189AE5481074C161AE9386FC896F2275CF3949FD0B72DDA0053E9DB350E903B6E6FF522E7C106254B7142F129FD15AF04B1987B0C12F7948C78DC4E64D273CFBCAE243662FFFF6DA03E8E9F68D105D941431709FC9089DDC538057E6B9D64B714D66C0BAC9DB9E171623B9CF39A9C5B914AD514F953C6D615B81DCDCB13D0315C938E53AAE52AB390EB0158A020802F7AAE5CD216E899033EE1CC5BD957FE7B85C57A16CB9A0E2C963BAA852B249F92027E4A9607B20B704B6CE3BB576F9DC2640136FD0364995D989EF3D51983C4FD61A449FA5BBF3CBE33D8F4C0D19AC11440C22FB8A0F1DCF01A5B837595417B46F9922618516BECBAA7D89C194402FA1965537CAB19F5A8B05317BC0DC342BBC3B099CE4A76FE3709921DA78B8C61C7CAF3C3DAC6B580E9CC852DD3587B522D0C2A359E21C5BE4679BD5D08E55C55D92BEB69A3366CFD6EF8EF32BD3F9B6533EA207B61092471B0BC4695FB2CEA9D7245AA6E65C1417B3D0B377ECDF0C0AFF994D93F4060CEDAC751FC8F97780317FC1D267654DA8FD10EFD7CB64D7C9102D27D17808F1B90DA2119B7376BD736A65B7C870404D2F5731A8B439A9E6DF4B399683211D2469A7E810FCE768604F77021BE62849C21C3158388F9809BEDEA6EAD7B4412245A06207F0B1F4C2FE72403C71AA7DF643588CF77DA4D2C05D5DA8B5848199D65A3B09604EA09F03BDCA7972D35225083C084C3E903F255C475F1188F0A4FB5EBC67FC86F5C369634B9F8C85E7C13E0A36F89AD11D28CCE144F54462DCF18337236A2C44AD7800CFCC0B87CFE6E836CA3F0F41E297C792DAA1B990D1FA9F6AE0765CC954B180D5DBAC8521BBF964A41A7FD00FA322DD8802D4BD837E26E0A2C5D56CD31979BD125EBF9F27F932E8D27A8AFCBB47652BB61769811505C0B9718C634CAD8F7B18EEE0076B59A354D0B94B2AED24FE4837766AB8B349C1902C89B654B533B221682C302204E5B741730CDAC6DC8D024EBAEA7EE06139451276D2961E6C9291162563D56B006AA1155B154FEDB499AEC46300605038C8BADBCBC5CFAA8FB5415E66546A96EF2B987D604F1C6BEA82CE85EB4900A20EF4E9BF03C881F6505024DD303B513C620A067696F262272E1CA5D8FF43BD1A74685CC57254CC1319CE77240FEEE21BC70A9AF25B5A074B8668D7491482E854EAD8C1037ECE08D0F440EA2E10BBF56635AFBA31D833CF2A4C6B6E749105074C62BC8F6CCEBC0FF3AE4E8D949CF5105C8ACA825A8B40A7B0639A055807D808289BAA20617C564D564F8F3AF5840317B64B4C75AD79A24733654C17CEBDE492EB70D3933E0F1A6EFD83393BC1F052A8B3E1FD17C1C61C856414F065F4C85FFF712A7DE06F252896397")
  if oqs.Signature("SPHINCS+-SHAKE-128f-simple").verify(slh_msg,slh_sig,slh_pk):
    class SLHDSASHAKE128fSignature(oqs.Signature):
      siglen = 17088
      # We do pure SLH-DSA, with an empty context string
      dsctx = b'\x00\x00'
      def __init__(self, secret_key=None):
        if not (secret_key is None):
          self.public_key = secret_key[-32:] # last 32 bytes of secret key is the public key
        super().__init__("SPHINCS+-SHAKE-128f-simple", secret_key=secret_key)
      def sign(self, message):
        return super().sign(self.dsctx + message)
      def verify(self, message, signature, public_key):
        return super().verify(self.dsctx + message, signature, public_key)
      def generate_keypair(self):
        pk = super().generate_keypair()
        self.public_key = bytes(pk)
        return self.public_key,self.export_secret_key()
      def export_public_key(self):
        return bytes(self.public_key)
      def export_secret_key(self):
        return bytes(super().export_secret_key())
    warnings.warn("Enabling support for post quantum (SLH-DSA-SHAKE-128f) signatures.",category=RuntimeWarning)

except ImportError:
  pass

class PublicKeyError(Exception):
  """
  Error converting to a public key
  """

class SecretKeyError(Exception):
  """
  Error converting to a secret key
  """

def get_pks(pk0):
  if isinstance(pk0, (SignPublicKey,KEMPublicKey)):
    return pk0
  elif isinstance(pk0, (list,tuple)):
    if isinstance(pk0[0], (int,)): # versioned
      try:
        return SignPublicKey(pk0)
      except PublicKeyError:
        return KEMPublicKey(pk0)
    else:
      # list of public keys
      rv = []
      for pk in pk0:
        rv.append(get_pks(pk))
      return rv
  elif isinstance(pk0, (bytes,bytearray)) and len(pk0) != 32: # no need to check 64, since this is only public keys
    try:
      return SignPublicKey(pk0)
    except PublicKeyError:
      return KEMPublicKey(pk0)
  else:
    # implicit version 1, treat as sign public key for now
    return SignPublicKey([1, pk0])

# Public keys used for signing.
# version is an integer that determines the meaning of keys.
#  --> except version 1, values should be unique between Sign and KEM classes
# version   keys
# -------   -------
#    1      bytes representing an Ed25519 public key
#    4      list of two items: Ed25519 public key bytes, SLH-DSA-SHAKE-128f public key bytes
class SignPublicKey(object):
  version = 0
  keys = b''
  def __init__(self, pk0):
    if isinstance(pk0, (SignPublicKey,)):
      self.version = pk0.version
      self.keys = pk0.keys
    elif isinstance(pk0, (list,tuple)):
      if isinstance(pk0[0], (int,)) and (pk0[0] == 1 or pk0[0] == 4): # currently only version 1,4 supported
        self.version = pk0[0]
        self.keys = pk0[1]
      else:
        # list of public keys
        raise PublicKeyError()
    elif isinstance(pk0, (SignSecretKey,)): # generating public key from secret key is allowed
      if pk0.version == 4:
        self.version = 4
        # compute public keys in situ
        self.keys = [pysodium.crypto_sign_sk_to_pk(pk0.keys[0]),pk0.slhdsashake128f.export_public_key()]
      else:
        # default version 1
        self.version = 1
        self.keys = pysodium.crypto_sign_sk_to_pk(pk0.keys)
    elif isinstance(pk0, (bytes,bytearray)) and len(pk0) == 32:
      # implicit version 1
      self.version = 1
      self.keys = pk0
    else:
      # implicit msgpacked bytes
      pk0 = msgpack.unpackb(pk0,raw=False)
      if not (pk0[0] in [1,4]):
        raise PublicKeyError()
      self.version = pk0[0]
      self.keys = pk0[1]
    # for ctypes calling compatibility (see also __len__ and __getitem__ below)
    self._as_parameter_ = bytes(self)
  def __bytes__(self):
    if self.version == 1:
      return self.keys
    else:
      return msgpack.packb([self.version, self.keys],use_bin_type=True)
  def __str__(self):
    if self.version == 1:
      return "(Ed25519, " + self.keys.hex() + ")"
    elif self.version == 4:
      return "(Ed25519-SLH-DSA-SHAKE-128f, [" + self.keys[0].hex() + "," + self.keys[1].hex() + "])"
    else:
      return "(Unparsable)"
  def get_type(self):
    return self.version
  def same_type(self, pk2):
    # Handle implicit version 1 too
    if isinstance(pk2, (bytes,bytearray,)):
      pk2 = SignPublicKey(pk2)
    if isinstance(pk2, (SignPublicKey,)) and self.version == pk2.version:
      return True
    if isinstance(pk2, (int,)) and self.version == pk2:
      return True
    return False
  def __eq__(self, pk2):
    if not self.same_type(pk2):
      return False
    if self.version == 1 and self.keys == pk2.keys:
      return True
    elif self.version == 4 and self.keys[0] == pk2.keys[0] and self.keys[1] == pk2.keys[1]:
      return True
    return False
  def __len__(self):
    return len(self._as_parameter_)
  def __getitem__(self, index):
    return self._as_parameter_[index]
  def __iter__(self):
    return iter([self.version, self.keys])
  def msgpack_pack(self):
    if self.version == 1:
      return self.keys
    else:
      return list(self)
  def crypto_sign_open(self, cso):
    if self.version == 1:
      return pysodium.crypto_sign_open(cso,self.keys)
    elif self.version == 4:
      if len(cso) < SLHDSASHAKE128fSignature.siglen+32: # Must be at least SLH-DSA-SHAKE-128f + Ed25519 signature bytes long
        raise PublicKeyError
      slhdsasig = cso[0:SLHDSASHAKE128fSignature.siglen]
      slhdsamsg = cso[SLHDSASHAKE128fSignature.siglen:]
      if not SLHDSASHAKE128fSignature().verify(slhdsamsg, slhdsasig, self.keys[1]):
        raise PublicKeyError
      return pysodium.crypto_sign_open(slhdsamsg, self.keys[0])
    raise PublicKeyError

# Secret keys used for signing.
# version is an integer that determines the meaning of keys.
#  --> except version 1, values should be unique between Sign and KEM classes
# version   keys
# -------   -------
#    1      bytes representing an Ed25519 secret key (32)
#    4      list of two items: Ed25519 secret key bytes (32), SLH-DSA-SHAKE-128f secret key bytes
class SignSecretKey(object):
  version = 0
  keys = b''
  def __init__(self, pk0):
    if isinstance(pk0, (SignSecretKey,)):
      self.version = pk0.version
      self.keys = pk0.keys
    elif isinstance(pk0, (list,tuple)):
      if isinstance(pk0[0], (int,)) and (pk0[0] == 1 or pk0[0] == 4): # currently only version 1,4 supported
        self.version = pk0[0]
        self.keys = pk0[1]
        if self.version == 4:
          self.slhdsashake128f = SLHDSASHAKE128fSignature(self.keys[1])
      else:
        # list of secret keys
        raise SecretKeyError()
    elif isinstance(pk0,(bytes,bytearray)):
      if len(pk0) == 64:
        # implicit version 1
        self.version = 1
        self.keys = pk0
      else:
        # implicit msgpacked bytes
        pk0 = msgpack.unpackb(pk0,raw=False)
        if not (pk0[0] in [1,4]):
          raise SecretKeyError()
        self.version = pk0[0]
        self.keys = pk0[1]
        if self.version == 4:
          self.slhdsashake128f = SLHDSASHAKE128fSignature(self.keys[1])
    else:
      # assume version is what was passed
      if pk0 == 4:
        self.version = 4
        # Ed25519 keypair
        pk,sk = pysodium.crypto_sign_keypair()
        self.keys = [sk] # Ed25519 key first
        self.slhdsashake128f = SLHDSASHAKE128fSignature()
        pk,sk = self.slhdsashake128f.generate_keypair()
        self.keys += [sk] # SLH-DSA-SHAKE-128f secret key second
      else:
        # default to version 1
        self.version = 1
        # Ed25519 keypair
        pk,sk = pysodium.crypto_sign_keypair()
        self.keys = sk
    # for ctypes calling compatibility (see also __len__ and __getitem__ below)
    self._as_parameter_ = bytes(self)
  def __bytes__(self):
    if self.version == 1:
      return self.keys
    else:
      return msgpack.packb([self.version, self.keys],use_bin_type=True)
  def __str__(self):
    if self.version == 1:
      return "(Ed25519-Secret, " + self.keys.hex() + ")"
    elif self.version == 4:
      return "(Ed25519-SLH-DSA-SHAKE-128f-Secret, [" + self.keys[0].hex() + "," + self.keys[1].hex() + "])"
    else:
      return "(Unparsable)"
  def get_type(self):
    return self.version
  def __eq__(self, pk2):
    if isinstance(pk2, (SignSecretKey,)) and self.version == pk2.version:
      if self.version == 1 and self.keys == pk2.keys:
        return True
      elif self.version == 4 and self.keys[0] == pk2.keys[0] and self.keys[1] == pk2.keys[1]:
        return True
    return False
  def __len__(self):
    return len(self._as_parameter_)
  def __getitem__(self, index):
    return self._as_parameter_[index]
  def __iter__(self):
    return iter([self.version, self.keys])
  def msgpack_pack(self):
    if self.version == 1:
      return self.keys
    else:
      return list(self)
  def crypto_sign(self, cs):
    if self.version == 1:
      return pysodium.crypto_sign(cs,self.keys)
    elif self.version == 4:
      edmsg = pysodium.crypto_sign(cs,self.keys[0])
      slhdsasig = self.slhdsashake128f.sign(edmsg)
      return bytes(slhdsasig) + bytes(edmsg)
    raise SecretKeyError

# Public keys used for key exchange.
# version is an integer that determines the meaning of keys.
#  --> except version 1, values should be unique between Sign and KEM classes
# version   keys
# -------   -------
#    1      bytes representing an Curve25519 public key
#    2      list of two items: Curve25519 pk bytes, sntrup761 pk bytes
#    3      list of two items: Curve25519 pk bytes, sntrup761 ct bytes
#    5      list of two items: Curve25519 pk bytes, ML-KEM-1024 pk bytes
#    6      list of two items: Curve25519 pk bytes, ML-KEM-1024 ct bytes
class KEMPublicKey(object):
  version = 0
  keys = b''
  def __init__(self, pk0):
    if isinstance(pk0, (SignPublicKey,)) and pk0.version == 1: # we allow conversion of implicit version 1 keys between Sign and KEM types
      self.version = pk0.version
      self.keys = pk0.keys
    elif isinstance(pk0, (KEMPublicKey,)):
      self.version = pk0.version
      self.keys = pk0.keys
    elif isinstance(pk0, (KEMSecretKey,)): # generating public key from secret key is allowed
      if pk0.version == 6:
        self.version = 6
        # compute Curve25519 public key in situ, include ML-KEM-1024 encapped ciphertext
        self.keys = [pysodium.crypto_scalarmult_curve25519_base(pk0.keys[0]),pk0.keys[1][2]]
      elif pk0.version == 5:
        self.version = 5
        # compute Curve25519 public key in situ, include ML-KEM-1024 public key
        self.keys = [pysodium.crypto_scalarmult_curve25519_base(pk0.keys[0]),pk0.keys[1][1]]
      elif pk0.version == 3:
        self.version = 3
        # compute Curve25519 public key in situ, include sntrup761 encapped ciphertext
        self.keys = [pysodium.crypto_scalarmult_curve25519_base(pk0.keys[0]),pk0.keys[1][2]]
      elif pk0.version == 2:
        self.version = 2
        # compute Curve25519 public key in situ, include sntrup761 public key
        self.keys = [pysodium.crypto_scalarmult_curve25519_base(pk0.keys[0]),pk0.keys[1][1]]
      else:
        # default version 1
        self.version = 1
        self.keys = pysodium.crypto_scalarmult_curve25519_base(pk0.keys)
    elif isinstance(pk0, (list,tuple)):
      if isinstance(pk0[0], (int,)) and (pk0[0] == 1 or pk0[0] == 2 or pk0[0] == 3 or pk0[0] == 5 or pk0[0] == 6): # Versions 1-3,5-6 only
        self.version = pk0[0]
        self.keys = pk0[1]
      else:
        # list of public keys
        raise PublicKeyError()
    elif isinstance(pk0, (bytes,bytearray)) and len(pk0) == 32:
      # implicit version 1
      self.version = 1
      self.keys = pk0
    else:
      # implicit msgpacked bytes
      pk0 = msgpack.unpackb(pk0,raw=False)
      if not (pk0[0] in [1,2,3,5,6]):
        raise PublicKeyError()
      self.version = pk0[0]
      self.keys = pk0[1]

    # for ctypes calling compatibility (see also __len__ and __getitem__ below)
    self._as_parameter_ = bytes(self)
  def __bytes__(self):
    if self.version == 1:
      return self.keys
    else:
      return msgpack.packb([self.version, self.keys],use_bin_type=True)
  def __str__(self):
    if self.version == 1:
      return "(Curve25519-pk, " + self.keys.hex() + ")"
    elif self.version == 2:
      return "(Curve25519-sntrup761-pk, [" + self.keys[0].hex() + "," + self.keys[1].hex() + "])"
    elif self.version == 3:
      return "(Curve25519-sntrup761-ct, [" + self.keys[0].hex() + "," + self.keys[1].hex() + "])"
    elif self.version == 5:
      return "(Curve25519-ML-KEM-1024-pk, [" + self.keys[0].hex() + "," + self.keys[1].hex() + "])"
    elif self.version == 6:
      return "(Curve25519-ML-KEM-1024-ct, [" + self.keys[0].hex() + "," + self.keys[1].hex() + "])"
    else:
      return "(Unparsable)"
  def get_type(self):
    return self.version
  def __eq__(self, pk2):
    if isinstance(pk2, (KEMPublicKey,)) and self.version == pk2.version:
      if self.version == 1 and self.keys == pk2.keys:
        return True
      elif (self.version == 2 or self.version == 3) and self.keys[0] == pk2.keys[0] and self.keys[1] == pk2.keys[1]:
        return True
      elif (self.version == 5 or self.version == 6) and self.keys[0] == pk2.keys[0] and self.keys[1] == pk2.keys[1]:
        return True
    return False
  def __len__(self):
    return len(self._as_parameter_)
  def __getitem__(self, index):
    return self._as_parameter_[index]
  def __iter__(self):
    return iter([self.version, self.keys])
  def get_esk_version(self):
    if self.version == 6: # 5 and 6 form a single esk unit
      return 5
    elif self.version == 3: # 2 and 3 form a single esk unit
      return 2
    else:
      return self.version
  def msgpack_pack(self):
    if self.version == 1:
      return self.keys
    else:
      return list(self)
  def crypto_box_seal(self, msg0):
    if self.version in [1,2,5]:
      esk = KEMSecretKey(self.version) # create ephemeral keypair of same type
      nonce = pysodium.randombytes(pysodium.crypto_secretbox_NONCEBYTES)
      secret = esk.complete_kem(self) # create initial secret
      epk = KEMPublicKey(esk) # for KEMs, getting "public part" (=ciphertext) must be done after creating initial secret
      prefix = len(bytes(epk)).to_bytes(2,'big') + len(nonce).to_bytes(2,'big')
      # create shared secret as sha256 of (2-bytes epk length) || (2-bytes nonce length) || bytes(self) || bytes(epk) || nonce || secret
      ss = pysodium.crypto_hash_sha256(prefix + bytes(self) + bytes(epk) + nonce + secret)[0:pysodium.crypto_secretbox_KEYBYTES]
      # create message as (2-bytes epk length) || (2-bytes nonce length) || bytes(epk) || nonce || secret_box
      msg = prefix + bytes(epk) + nonce + pysodium.crypto_secretbox(msg0,nonce,ss)
      return msg
    else:
      raise PublicKeyError()


# Secret keys used for key exchange.
# version is an integer that determines the meaning of keys.
#  --> should have the same versions as KEMPublicKey
# version   keys
# -------   -------
#    1      bytes representing an Curve25519 secret key
#   2,3     list of two items: Curve25519 bytes, sntrup761 bytes list [sk,pk,ct (v. 3 only)]
#   5,6     list of two items: Curve25519 bytes, ML-KEM-1024 bytes list [sk,pk,ct (v. 6 only)]
class KEMSecretKey(object):
  version = 0
  keys = b''
  def __init__(self, pk0):
    if isinstance(pk0, (KEMSecretKey,)):
      self.version = pk0.version
      self.keys = pk0.keys
    elif isinstance(pk0, (list,tuple)):
      if isinstance(pk0[0], (int,)) and (pk0[0] == 1 or pk0[0] == 2 or pk0[0] == 3 or pk0[0] == 5 or pk0[0] == 6): # versions 1-3,5-6 only
        self.version = pk0[0]
        self.keys = pk0[1]
        if self.version == 2 or self.version == 3:
          self.sntrup761 = oqs.KeyEncapsulation("sntrup761", secret_key=self.keys[1][0])
        if self.version == 5 or self.version == 6:
          self.mlkem1024 = oqs.KeyEncapsulation("ML-KEM-1024", secret_key=self.keys[1][0])
      else:
        # list of secret keys
        raise SecretKeyError()
    elif isinstance(pk0,(bytes,bytearray)):
      if len(pk0) == 32:
        # implicit version 1
        self.version = 1
        self.keys = pk0
      else:
        # implicit msgpacked bytes
        pk0 = msgpack.unpackb(pk0,raw=False)
        if not (pk0[0] in [1,2,3,5,6]):
          raise SecretKeyError()
        self.version = pk0[0]
        self.keys = pk0[1]
        if self.version == 2 or self.version == 3:
          self.sntrup761 = oqs.KeyEncapsulation("sntrup761", secret_key=self.keys[1][0])
        if self.version == 5 or self.version == 6:
          self.mlkem1024 = oqs.KeyEncapsulation("ML-KEM-1024", secret_key=self.keys[1][0])
    else:
      # assume version is what was passed
      if pk0 == 6:
        raise SecretKeyError() # cannot create type-6 directly, requires a complete_kem call
      elif pk0 == 5:
        self.version = 5
        self.keys = [pysodium.randombytes(pysodium.crypto_scalarmult_curve25519_BYTES)] # Curve25519 key first
        self.mlkem1024 = oqs.KeyEncapsulation("ML-KEM-1024")
        pk = self.mlkem1024.generate_keypair()
        self.keys += [[self.mlkem1024.export_secret_key(),pk]] # ML-KEM-1024 key second (store both secret and public key)
      elif pk0 == 3:
        raise SecretKeyError() # cannot create type-3 directly, requires a complete_kem call
      elif pk0 == 2:
        self.version = 2
        self.keys = [pysodium.randombytes(pysodium.crypto_scalarmult_curve25519_BYTES)] # Curve25519 key first
        self.sntrup761 = oqs.KeyEncapsulation("sntrup761")
        pk = self.sntrup761.generate_keypair()
        self.keys += [[self.sntrup761.export_secret_key(),pk]] # sntrup761 key second (store both secret and public key)
      else:
        # default to version 1
        self.version = 1
        self.keys = pysodium.randombytes(pysodium.crypto_scalarmult_curve25519_BYTES)
    # for ctypes calling compatibility (see also __len__ and __getitem__ below)
    self._as_parameter_ = bytes(self)
  def __bytes__(self):
    if self.version == 1:
      return self.keys
    else:
      return msgpack.packb([self.version, self.keys],use_bin_type=True)
  def __str__(self):
    if self.version == 1:
      return "(Curve25519-Secret, " + self.keys.hex() + ")"
    elif self.version == 2:
      return "(Curve25519-sntrup761-Secret, [" + self.keys[0].hex() + ",[" + self.keys[1][0].hex() + "," + self.keys[1][1].hex() + "]])"
    elif self.version == 3:
      return "(Curve25519-sntrup761-Secret-ct, [" + self.keys[0].hex() + ",[" + self.keys[1][0].hex() + "," + self.keys[1][1].hex() + "," + self.keys[1][2].hex() + "]])"
    elif self.version == 5:
      return "(Curve25519-ML-KEM-1024-Secret, [" + self.keys[0].hex() + ",[" + self.keys[1][0].hex() + "," + self.keys[1][1].hex() + "]])"
    elif self.version == 6:
      return "(Curve25519-ML-KEM-1024-Secret-ct, [" + self.keys[0].hex() + ",[" + self.keys[1][0].hex() + "," + self.keys[1][1].hex() + "," + self.keys[1][2].hex() + "]])"
    else:
      return "(Unparsable)"
  def get_type(self):
    return self.version
  def __eq__(self, pk2):
    if isinstance(pk2, (KEMSecretKey,)) and self.version == pk2.version:
      if self.version == 1 and self.keys == pk2.keys:
        return True
      elif self.version == 2 and self.keys[0] == pk2.keys[0] and self.keys[1][0] == pk2.keys[1][0] and self.keys[1][1] == pk2.keys[1][1]:
        return True
      elif self.version == 3 and self.keys[0] == pk2.keys[0] and self.keys[1][0] == pk2.keys[1][0] and self.keys[1][1] == pk2.keys[1][1] and self.keys[1][2] == pk2.keys[1][2]:
        return True
      elif self.version == 5 and self.keys[0] == pk2.keys[0] and self.keys[1][0] == pk2.keys[1][0] and self.keys[1][1] == pk2.keys[1][1]:
        return True
      elif self.version == 6 and self.keys[0] == pk2.keys[0] and self.keys[1][0] == pk2.keys[1][0] and self.keys[1][1] == pk2.keys[1][1] and self.keys[1][2] == pk2.keys[1][2]:
        return True
    return False
  def __len__(self):
    return len(self._as_parameter_)
  def __getitem__(self, index):
    return self._as_parameter_[index]
  def __iter__(self):
    return iter([self.version, self.keys])
  def msgpack_pack(self):
    if self.version == 1:
      return self.keys
    else:
      return list(self)
  def complete_kem(self, pubkey):
    if self.version == 1 and pubkey.version == 1:
      return pysodium.crypto_scalarmult_curve25519(self.keys,pubkey.keys)
    elif (self.version == 2 or self.version == 3) and pubkey.version == 2:
      part0 = pysodium.crypto_scalarmult_curve25519(self.keys[0],pubkey.keys[0])
      ct, part1 = self.sntrup761.encap_secret(pubkey.keys[1])
      if self.version == 2:
        self.version = 3
        self.keys[1].append(ct)
      else: # self.version is already 3
        self.keys[1][2] = ct
      return part0 + part1
    elif self.version == 2 and pubkey.version == 3: # cannot do 3 with 3 since we don't have partner pk
      part0 = pysodium.crypto_scalarmult_curve25519(self.keys[0],pubkey.keys[0])
      part1 = self.sntrup761.decap_secret(pubkey.keys[1])
      return part0 + part1
    elif (self.version == 5 or self.version == 6) and pubkey.version == 5:
      part0 = pysodium.crypto_scalarmult_curve25519(self.keys[0],pubkey.keys[0])
      ct, part1 = self.mlkem1024.encap_secret(pubkey.keys[1])
      if self.version == 5:
        self.version = 6
        self.keys[1].append(ct)
      else: # self.version is already 6
        self.keys[1][2] = ct
      return part0 + part1
    elif self.version == 5 and pubkey.version == 6: # cannot do 6 with 6 since we don't have partner pk
      part0 = pysodium.crypto_scalarmult_curve25519(self.keys[0],pubkey.keys[0])
      part1 = self.mlkem1024.decap_secret(pubkey.keys[1])
      return part0 + part1
    else:
      raise SecretKeyError()
  def crypto_box_seal_open(self, msg0):
    if self.version in [1,2,5]:
      try:
        # message is (2-bytes epk length) || (2-bytes nonce length) || bytes(epk) || nonce || secret_box
        # get epk and nonce lengths
        prefix = msg0[0:4]
        epklen = int.from_bytes(msg0[0:2],'big')
        noncelen = int.from_bytes(msg0[2:4],'big')
        if epklen+noncelen+4 > len(msg0):
          raise SecretKeyError()
        epk = KEMPublicKey(msg0[4:(4+epklen)])
        nonce = msg0[(4+epklen):(4+epklen+noncelen)]
        ourpk = KEMPublicKey(self) # need our pk before calling complete_kem
        secret = self.complete_kem(epk) # create initial secret
        # create shared secret as sha256 of (2-bytes epk length) || (2-bytes nonce length) || bytes(self-pk) || bytes(epk) || nonce || secret
        ss = pysodium.crypto_hash_sha256(prefix + bytes(ourpk) + bytes(epk) + nonce + secret)[0:pysodium.crypto_secretbox_KEYBYTES]
        msg = pysodium.crypto_secretbox_open(msg0[(4+epklen+noncelen):],nonce,ss)
        return msg
      except Exception as e:
        if self.version == 1:
          # might be a direct sealed box (legacy)
          return pysodium.crypto_box_seal_open(msg0, KEMPublicKey(self).keys, self.keys)
        raise e
    else:
      raise SecretKeyError()
